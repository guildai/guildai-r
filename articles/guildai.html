<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="guildai">
<title>Introduction to Guild AI for R • guildai</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Guild AI for R">
<meta property="og:description" content="guildai">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">guildai</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/guildai.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples/keras.html">keras</a>
    <a class="dropdown-item" href="../articles/examples/xgboost.html">xgboost</a>
    <a class="dropdown-item" href="../articles/examples/tidymodels.html">tidymodels</a>
    <a class="dropdown-item" href="../articles/examples/mlr3.html">mlr3</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/guildai/guildai-r/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to Guild AI for R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/guildai/guildai-r/blob/HEAD/vignettes/guildai.Rmd" class="external-link"><code>vignettes/guildai.Rmd</code></a></small>
      <div class="d-none name"><code>guildai.Rmd</code></div>
    </div>

    
    
<!-- TODO a nice screenshot image here-->
<p><em>guildai</em> provides a suite of tools for tracking, visualizing,
and managing machine learning experiments. The <em>guildai</em> R
package is a successor to the <em>tfruns</em> package.</p>
<ul>
<li><p>Track the hyperparameters, metrics, output, and source code of
every training run.</p></li>
<li><p>Compare hyperparameters and metrics across runs to find the best
performing model.</p></li>
<li><p>No changes to source code required.</p></li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The R package provides an interface to <a href="https://guild.ai/" class="external-link">Guild AI Core</a>. The R package will
automatically download and install Guild AI Core on first use, or you
can call <code><a href="../reference/install_guild.html">install_guild()</a></code> directly to customize the
installation.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("guildai")</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span>, repos <span class="op">=</span> <span class="st">"https://cran.rstudio.com"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"guildai/guildai-r"</span><span class="op">)</span></span>
<span><span class="fu">guildai</span><span class="fu">::</span><span class="fu"><a href="../reference/install_guild.html">install_guild</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="launch-a-run">Launch a Run<a class="anchor" aria-label="anchor" href="#launch-a-run"></a>
</h2>
<p>Guild AI can be used with any machine learning framework, or no
framework at all. The Examples section in the top navbar shows how you
can use guild with common machine learning frameworks like XGBoost,
TensorFlow and Keras, Torch, mlr3 and Tidymodels.</p>
<p>In this introductory example, we’ll start by showing guild with no
framework at all, on a very simple (and somewhat contrived) example.</p>
<p>Say we have an R script named <code>"train.R"</code> where we are
fitting a smoother line, like so:</p>
<div class="cell">

</div>
<div class="cell" file="train.R">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="guildai_files/figure-markdown/unnamed-chunk-3-1.png"></p>
</div>
</div>
<p>To train a model with guildai, use the <code><a href="../reference/guild_run.html">guild_run()</a></code>
function in place of the <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> function to execute your
R script. For example:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://guildai.github.io/guildai-r/">guildai</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span><span class="op">)</span></span>
<span><span class="co">## &gt; model &lt;- loess(dist ~ speed, data = cars)</span></span>
<span><span class="co">## &gt; plot(dist ~ speed, data = cars)</span></span>
<span><span class="co">## &gt; lines(x = 3:30, y = predict(model, 3:30), col = "blue")</span></span></code></pre></div>
</div>
<p>This will launch a new R process in an isolated run directory using
the provided script. By default, the output stream from the run will be
shown at the R console (the same output stream you would see with
<code>source("train.R", echo = TRUE)</code> in the R console, or
<code>R --file=train.R</code> in the terminal).</p>
</div>
<div class="section level2">
<h2 id="view-runs">View Runs<a class="anchor" aria-label="anchor" href="#view-runs"></a>
</h2>
<div class="section level3">
<h3 id="in-an-interactive-application">In an Interactive Application<a class="anchor" aria-label="anchor" href="#in-an-interactive-application"></a>
</h3>
<p>Call <code><a href="../reference/guild_view.html">guild_view()</a></code> to launch the <em>Guild View</em>
application, which you can use to visualize and manage your runs. You
can use it to search, filter, visualize, compare run source code and
output, and more! It also bundles TensorBoard as an additional
visualization tool for viewing runs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_view.html">guild_view</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/guild-view-screenshot.png"></p>
</div>
<div class="section level3">
<h3 id="in-r">In R<a class="anchor" aria-label="anchor" href="#in-r"></a>
</h3>
<p>Retrieve a data frame with run information in R using
<code><a href="../reference/runs_info.html">runs_info()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">run</span><span class="op">)</span></span>
<span><span class="co">## Rows: 1</span></span>
<span><span class="co">## Columns: 15</span></span>
<span><span class="co">## $ label       &lt;chr&gt; ""</span></span>
<span><span class="co">## $ tags        &lt;list&gt; &lt;&gt;</span></span>
<span><span class="co">## $ marked      &lt;lgl&gt; FALSE</span></span>
<span><span class="co">## $ flags       &lt;tibble[,0]&gt; &lt;tbl_df[1 x 0]&gt;</span></span>
<span><span class="co">## $ scalars     &lt;tibble[,0]&gt; &lt;tbl_df[1 x 0]&gt;</span></span>
<span><span class="co">## $ operation   &lt;chr&gt; "train.R"</span></span>
<span><span class="co">## $ started     &lt;dttm&gt; 2023-02-28 11:08:37</span></span>
<span><span class="co">## $ stopped     &lt;dttm&gt; 2023-02-28 11:08:37</span></span>
<span><span class="co">## $ comments    &lt;list&gt; [&lt;tbl_df[0 x 4]&gt;]</span></span>
<span><span class="co">## $ status      &lt;chr&gt; "completed"</span></span>
<span><span class="co">## $ exit_status &lt;int&gt; 0</span></span>
<span><span class="co">## $ deps        &lt;list&gt; []</span></span>
<span><span class="co">## $ project_dir &lt;chr&gt; "/tmp/RtmpA9r0F6/guildai-intro-sample-project-4acc12bdedaa"</span></span>
<span><span class="co">## $ dir         &lt;chr&gt; "/tmp/RtmpA9r0F6/guildai-intro-sample-project-4acc12bdedaa…</span></span>
<span><span class="co">## $ id          &lt;chr&gt; "ffb3ea427301412b9347194a9e66bed1"</span></span></code></pre></div>
</div>
<p><code><a href="../reference/runs_info.html">runs_info()</a></code> returns a data frame with information about
runs, one row per run. In this introduction so far, we’ve only launched
1 run, so so <code><a href="../reference/runs_info.html">runs_info()</a></code> returns a 1-row data frame.</p>
<p><code><a href="../reference/runs_info.html">runs_info()</a></code> supports a rich set of filter options that
can be conveniently supplied. For example:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ls_runs</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>            <span class="co"># get the most recent run</span></span>
<span><span class="fu">ls_runs</span><span class="op">(</span>error <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># get only runs that returned an error</span></span></code></pre></div>
</div>
<p>See <code>?runs_info()</code> for more information.</p>
</div>
<div class="section level3">
<h3 id="in-the-filesystem">In the Filesystem<a class="anchor" aria-label="anchor" href="#in-the-filesystem"></a>
</h3>
<p><code><a href="../reference/guild_view.html">guild_view()</a></code> and <code><a href="../reference/runs_info.html">runs_info()</a></code> provide two
convenient ways to gather and present the information from runs.
Importantly however, the run directories themselves are easily
accessible. There you’ll find any files, plots, logs, or other output
generated by a run. The run directory also contains additional metadata
about the runs that guild recorded under the “.guild” folder. There
you’ll find plain text (yaml) files with information like the starting
random seed, environment variables, information about the package
versions, and other metadata frequently useful for reproducibility.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="va">run</span><span class="op">$</span><span class="va">dir</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## /tmp/RtmpA9r0F6/guildai-intro-sample-project-4acc12bdedaa/.guild/runs/ffb3ea427301412b9347194a9e66bed1</span></span>
<span><span class="co">## ├── .guild</span></span>
<span><span class="co">## │   ├── attrs</span></span>
<span><span class="co">## │   │   ├── cmd</span></span>
<span><span class="co">## │   │   ├── deps</span></span>
<span><span class="co">## │   │   ├── env</span></span>
<span><span class="co">## │   │   ├── exit_status</span></span>
<span><span class="co">## │   │   ├── flags</span></span>
<span><span class="co">## │   │   ├── host</span></span>
<span><span class="co">## │   │   ├── id</span></span>
<span><span class="co">## │   │   ├── initialized</span></span>
<span><span class="co">## │   │   ├── op</span></span>
<span><span class="co">## │   │   ├── platform</span></span>
<span><span class="co">## │   │   ├── plugins</span></span>
<span><span class="co">## │   │   ├── r_packages_loaded</span></span>
<span><span class="co">## │   │   ├── random_seed</span></span>
<span><span class="co">## │   │   ├── run_params</span></span>
<span><span class="co">## │   │   ├── sourcecode_digest</span></span>
<span><span class="co">## │   │   ├── started</span></span>
<span><span class="co">## │   │   ├── stopped</span></span>
<span><span class="co">## │   │   ├── user</span></span>
<span><span class="co">## │   │   └── user_flags</span></span>
<span><span class="co">## │   ├── manifest</span></span>
<span><span class="co">## │   ├── opref</span></span>
<span><span class="co">## │   ├── output</span></span>
<span><span class="co">## │   └── output.index</span></span>
<span><span class="co">## ├── plots</span></span>
<span><span class="co">## │   └── Rplot001.png</span></span>
<span><span class="co">## └── train.R</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="flags">Flags<a class="anchor" aria-label="anchor" href="#flags"></a>
</h2>
<p>Flags are a form of run inputs, or parameterization.
<code><a href="../reference/guild_run.html">guild_run()</a></code> can modify flags when launching runs, and
<code><a href="../reference/guild_view.html">guild_view()</a></code> and <code><a href="../reference/runs_info.html">runs_info()</a></code> make it easy to
compare flags across runs. Any scalar literal assigned at the top level
of a run script is automatically identified as a <em>flag</em>.</p>
<div class="section level3">
<h3 id="supplying-run-flag-values">Supplying run flag values<a class="anchor" aria-label="anchor" href="#supplying-run-flag-values"></a>
</h3>
<p>To illustrate, we’ll modify our script “train.R” by adding flags
<code>span</code> and <code>family</code>, which we pass as arguments to
the <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess()</a></code> smoother:</p>
<div class="cell">

</div>
<div class="cell" file="train.R">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">span</span> <span class="op">&lt;-</span> <span class="fl">.75</span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="st">"gaussian"</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">span</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>You can launch a run with different flag values like this:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  span <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"symmetric"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p><code><a href="../reference/guild_run.html">guild_run()</a></code> will modify the script file with the
requested flag values when starting the run, as if we had modified them
manually. This change is persistent, and will be visible when inspecting
the snapshot of run sources captured, e.g., with
<code><a href="../reference/guild_view.html">guild_view()</a></code> (or <code>guild diff</code>, or inspecting in
the filesystem).</p>
<p>The flags interface is useful for experimentation and hyperparameter
optimization. At it’s simplest, you can iterate over the set of flag
values you want and pass them to separate calls of
<code><a href="../reference/guild_run.html">guild_run()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">span</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span>, <span class="fl">1.25</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>span <span class="op">=</span> <span class="va">span</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>You can also pass multiple values for each flag, and guild will
automatically expand the combinations to a grid. For example, this will
launch 4 training runs, each a unique pairing of flags.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  span <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"symmetric"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Another way to launch a batch of runs is to pass a data frame of
flags values, with each row corresponding to a run.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flags_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>                        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"symmetric"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flags_df</span></span>
<span><span class="co">##   span    family</span></span>
<span><span class="co">## 1 0.50  gaussian</span></span>
<span><span class="co">## 2 0.75  gaussian</span></span>
<span><span class="co">## 3 0.50 symmetric</span></span>
<span><span class="co">## 4 0.75 symmetric</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, flags <span class="op">=</span> <span class="va">flags_df</span>, echo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="retreiving-run-flags">Retreiving run flags<a class="anchor" aria-label="anchor" href="#retreiving-run-flags"></a>
</h3>
<p>The flags and flag values associated with each runs are returned by
<code><a href="../reference/runs_info.html">runs_info()</a></code> as a packed dataframe under the
<code>flags</code> name.</p>
<div class="cell" paged.print="false">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="co"># retrieve the last 4 runs</span></span>
<span><span class="va">runs</span><span class="op">$</span><span class="va">flags</span></span>
<span><span class="co">## # A tibble: 4 × 2</span></span>
<span><span class="co">##   family     span</span></span>
<span><span class="co">##   &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">## 1 symmetric  0.75</span></span>
<span><span class="co">## 2 symmetric  0.5 </span></span>
<span><span class="co">## 3 gaussian   0.75</span></span>
<span><span class="co">## 4 gaussian   0.5</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="scalars">Scalars<a class="anchor" aria-label="anchor" href="#scalars"></a>
</h2>
<p>The counterpart to run <em>flags</em> are run <em>scalars</em>.
Whereas <em>flags</em> are a a special type of run input that guild can
help manage, <em>scalars</em> are special type of run output that guild
can help manage.</p>
<p>Any lines printed to stdout matching this pattern are identified as a
scalar:</p>
<pre class="verbatim"><code>key: &lt;numeric&gt;</code></pre>
<p>To illustrate, here is “train.R” updated to output two scalars,
<code>rmse</code> and <code>mse</code>.</p>
<div class="cell">

</div>
<div class="cell" file="train.R">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">span</span> <span class="op">&lt;-</span> <span class="fl">.75</span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="st">"gaussian"</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">span</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"mse:"</span>, <span class="va">mse</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"rmse:"</span>, <span class="va">rmse</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span><span class="op">)</span></span>
<span><span class="co">## &gt; span &lt;- .75</span></span>
<span><span class="co">## &gt; family &lt;- "gaussian"</span></span>
<span><span class="co">## &gt; model &lt;- loess(dist ~ speed, data = cars,</span></span>
<span><span class="co">## +                span = span, family = family)</span></span>
<span><span class="co">## &gt; plot(dist ~ speed, data = cars)</span></span>
<span><span class="co">## &gt; lines(x = 3:30, y = predict(model, 3:30), col = "blue")</span></span>
<span><span class="co">## &gt; mse &lt;- mean(residuals(model)^2)</span></span>
<span><span class="co">## &gt; rmse &lt;- sqrt(mse)</span></span>
<span><span class="co">## &gt; cat("mse:", mse, "\n")</span></span>
<span><span class="co">## mse: 207.274320377417 </span></span>
<span><span class="co">## &gt; cat("rmse:", rmse, "\n")</span></span>
<span><span class="co">## rmse: 14.3970247057306</span></span></code></pre></div>
</div>
<p>When the script is run, these two lines in the printed output are
identified by guild as scalars:</p>
<pre class="verbatim"><code><span><span class="va">mse</span><span class="op">:</span> <span class="fl">207.274320377417</span></span>
<span><span class="va">rmse</span><span class="op">:</span> <span class="fl">14.3970247057306</span></span></code></pre>
<p>We can retrieve the scalar results from runs with
<code><a href="../reference/runs_info.html">runs_info()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">scalars</span></span>
<span><span class="co">## # A tibble: 1 × 2</span></span>
<span><span class="co">##     mse  rmse</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1  207.  14.4</span></span></code></pre></div>
</div>
<p>Here we see that guild has automatically identified <code>rmse</code>
and <code>mse</code> as scalars.</p>
<p>If you are printing values for the same scalar <code>key</code>
multiple times during a run (e.g, <code>loss</code> during a training
loop), then be sure to also print a <code>step</code> scalar in between,
to enable guild to track history (and enable visualization of the run
metrics with Guild View and TensorBoard).</p>
<p><code><a href="../reference/runs_info.html">runs_info()</a></code> returns the last observed value for each run
scalar key, but the full history of scalars observed in runs can also be
accessed from R directly via <code><a href="../reference/runs_scalars.html">runs_scalars()</a></code>.</p>
<p>If the run produces tfevent records in the run directory (e.g., via
<code>keras::callback_tensorboard()</code> or
<code>tfevents::log_event()</code>), those are also automatically
identified by guild as run scalars, and included in
<code><a href="../reference/runs_info.html">runs_info()</a></code> (and <code><a href="../reference/guild_view.html">guild_view()</a></code>, and TensorBoard
and other run views).</p>
</div>
<div class="section level2">
<h2 id="guild-configuration">Guild Configuration<a class="anchor" aria-label="anchor" href="#guild-configuration"></a>
</h2>
<p>Guild accepts a variety of operation configuration options. One
convenient way of supplying configuration options is via hashpipe yaml
(<code>#|</code>) comments in the R script. Hashpipe comments are always
parsed as yaml (because yaml is a superset of json, json is also
valid).</p>
<div class="section level3">
<h3 id="operation-configuration">Operation configuration<a class="anchor" aria-label="anchor" href="#operation-configuration"></a>
</h3>
<p>Guild options can be supplied as hashpipe yaml in the frontmatter of
the script (in lines 1-n). For example, we can inform guild that guild
should not echo the R expressions in the stdout log by supplying
<code>echo: no</code> like this.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#| echo: no</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">span</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span></span></code></pre></div>
<p>A comprehensive listing of all the operation configuration options
that can be supplied to guild via script frontmatter can be found <a href="https://my.guild.ai/t/guild-file-reference/197#operation-attributes-6" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="flag-configuration">Flag configuration<a class="anchor" aria-label="anchor" href="#flag-configuration"></a>
</h3>
<p>You can optionally supply additional metadata about individual flags
by placing hashpipe yaml annotations above the flag expression.</p>
<div class="section level4">
<h4 id="flag-constraints">Flag constraints<a class="anchor" aria-label="anchor" href="#flag-constraints"></a>
</h4>
<p>For example, we can update our “train.R” script to add constraints to
the <code>span</code> and <code>family</code> flags. For
<code>span</code> we’ll set a range of valid values from 0.3–3.0. For
<code>family</code> we’ll define a set of two valid string values
<code>family</code> can take, <code>"gaussian"</code> or
<code>"symmetric"</code>.</p>
<div class="cell">

</div>
<div class="cell" file="train.R">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#| echo: no</span></span>
<span></span>
<span><span class="co">#| {min: .3, max: 3}</span></span>
<span><span class="va">span</span> <span class="op">&lt;-</span> <span class="fl">.75</span></span>
<span></span>
<span><span class="co">#| choices: [gaussian, symmetric]</span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="st">"gaussian"</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">span</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"rmse:"</span>, <span class="va">rmse</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Now if you attempt to launch the run with a flag value that’s outside
the constraints defined, guild will throw an error:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">99</span><span class="op">)</span><span class="op">)</span> <span class="co"># error</span></span>
<span><span class="co">## guild: invalid value 99.0 for span: out of range (greater than max 3)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="flag-destinations">Flag destinations<a class="anchor" aria-label="anchor" href="#flag-destinations"></a>
</h4>
<p>As a project grows, it can be helpful to be able to move flag
definitions out of the main R script. To do so, you can include a
<code>flags-dest</code> in the frontmatter of the R script, specifying
the file where guild should read and update the flag values. Then you
can read in the flag values in the main R script using
<code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> or similar.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#| flags-dest: ./flags.R</span></span>
<span></span>
<span><span class="va">FLAGS</span> <span class="op">&lt;-</span> <span class="fu">envir</span><span class="fu">::</span><span class="fu"><a href="https://t-kalinowski.github.io/envir/reference/include.html" class="external-link">include</a></span><span class="op">(</span><span class="st">"flags.R"</span>, <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">FLAGS</span><span class="op">$</span><span class="va">span</span>,</span>
<span>               family <span class="op">=</span> <span class="va">FLAGS</span><span class="op">$</span><span class="va">family</span><span class="op">)</span></span></code></pre></div>
<p>YAML files are also supported as a flags destination:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#| flags-dest: ./flags.yml</span></span>
<span></span>
<span><span class="va">FLAGS</span> <span class="op">&lt;-</span> <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html" class="external-link">read_yaml</a></span><span class="op">(</span><span class="st">"flags.yml"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">FLAGS</span><span class="op">$</span><span class="va">span</span>,</span>
<span>               family <span class="op">=</span> <span class="va">FLAGS</span><span class="op">$</span><span class="va">family</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="hyperparameter-optimization">Hyperparameter Optimization<a class="anchor" aria-label="anchor" href="#hyperparameter-optimization"></a>
</h2>
<p>The combination of flags with constraints and scalars make it
possible to use a hyperparameter optimizer with guild. Here,
<em>flags</em> are the hyperparameters, <em>flag constraints</em> define
the hyperparameter search space, and a <em>scalar</em> is the objective
to minimize or maximize.</p>
<p>To illustrate, here is an example run R script:</p>
<div class="cell">

</div>
<div class="cell" file="train.R">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#| echo: no</span></span>
<span></span>
<span><span class="co">#| {min: .3, max: 3}</span></span>
<span><span class="va">span</span> <span class="op">&lt;-</span> <span class="fl">.75</span></span>
<span></span>
<span><span class="co">#| choices: [gaussian, symmetric]</span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="st">"gaussian"</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span>,</span>
<span>               span <span class="op">=</span> <span class="va">span</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">~</span> <span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"rmse:"</span>, <span class="va">rmse</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>You can use an optimizer with this operation like so:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>,</span>
<span>          optimizer <span class="op">=</span> <span class="st">"bayesian"</span>,</span>
<span>          minimize <span class="op">=</span> <span class="st">"rmse"</span>,</span>
<span>          max_trials <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">## INFO: [guild] Random start for optimization (1 of 3)</span></span>
<span><span class="co">## INFO: [guild] Running trial d459fbb729ea449c909aa63ca82f8768: train.R (family=gaussian, span=0.75)</span></span>
<span><span class="co">## rmse: 14.3970247057306 </span></span>
<span><span class="co">## INFO: [guild] Random start for optimization (2 of 3)</span></span>
<span><span class="co">## INFO: [guild] Running trial 2eb6d34b54fd4a92b8f581cf0a9b05a1: train.R (family=symmetric, span=0.9547426502497127)</span></span>
<span><span class="co">## rmse: 14.8061751269351 </span></span>
<span><span class="co">## INFO: [guild] Random start for optimization (3 of 3)</span></span>
<span><span class="co">## INFO: [guild] Running trial 7368411050e34130b1ea801631c3a13b: train.R (family=gaussian, span=2.641665759567874)</span></span>
<span><span class="co">## rmse: 14.6885174763122 </span></span>
<span><span class="co">## INFO: [guild] Found 3 previous trial(s) for use in optimization</span></span>
<span><span class="co">## INFO: [guild] Running trial 3d6b88fd3df743488debcb18e9e18327: train.R (family=gaussian, span=0.3)</span></span>
<span><span class="co">## rmse: 12.3620973783366 </span></span>
<span><span class="co">## INFO: [guild] Found 4 previous trial(s) for use in optimization</span></span>
<span><span class="co">## INFO: [guild] Running trial 15a2f795dafd44cbb5ede55f8b12dfa8: train.R (family=symmetric, span=0.3)</span></span>
<span><span class="co">## rmse: 12.5758081076474</span></span></code></pre></div>
</div>
<p>See <a href="https://my.guild.ai/t/optimizers-reference/43" class="external-link">here</a>
for documentation on the optimizers built-in to guild.</p>
</div>
<div class="section level2">
<h2 id="managing-runs">Managing runs<a class="anchor" aria-label="anchor" href="#managing-runs"></a>
</h2>
<p>Guild comes with a family of functions for managing runs.</p>
<ul>
<li>Annotate runs: <code><a href="../reference/runs_label.html">runs_comment()</a></code>, <code><a href="../reference/runs_label.html">runs_mark()</a></code>
and <code><a href="../reference/runs_label.html">runs_tag()</a></code>.</li>
<li>Move, archive, or copy runs: <code><a href="../reference/runs_export.html">runs_export()</a></code> and
<code><a href="../reference/runs_export.html">runs_import()</a></code>.</li>
<li>Delete runs: <code><a href="../reference/runs_delete.html">runs_delete()</a></code> <code><a href="../reference/runs_delete.html">runs_purge()</a></code>
<code><a href="../reference/runs_delete.html">runs_restore()</a></code>.</li>
</ul>
<p>The <code>runs_*</code> family of functions all take
<code>runs</code> as a first argument, and can be composed with
<code>|&gt;</code>. The <code>runs</code> arguments can be supplied as
data frame, as returned by <code><a href="../reference/runs_info.html">runs_info()</a></code> or
<code><a href="../reference/runs_scalars.html">runs_scalars()</a></code>. <code>runs</code> can also be a character
vector, with a flexible syntax supported for specifying runs selections:
For example, <code>runs</code> can be an <code>id</code>, an integer
(the n-th last run), or any combination of filter specifications like
<code>running = TRUE</code> and <code>started  = 'last hour'</code>. See
<code>?runs_info()</code> for details.</p>
<p>To illustrate, lets launch a few runs and then investigate the
results from all our previous runs (including the 10 hyperparameter
optimization runs, as well as the runs with flag values we manually
launched earlier in this guide):</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, echo <span class="op">=</span> <span class="cn">FALSE</span>, flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  span <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">1.5</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symmetric"</span>, <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell" paged.print="false">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">runs</span></span>
<span><span class="co">## # A tibble: 21 × 15</span></span>
<span><span class="co">##    label                tags  marked flags…¹ scala…² opera…³ started            </span></span>
<span><span class="co">##    &lt;chr&gt;                &lt;lis&gt; &lt;lgl&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;             </span></span>
<span><span class="co">##  1 family=gaussian spa… &lt;chr&gt; FALSE  gaussi…    14.6 train.R 2023-02-28 11:08:56</span></span>
<span><span class="co">##  2 family=gaussian spa… &lt;chr&gt; FALSE  gaussi…    14.6 train.R 2023-02-28 11:08:56</span></span>
<span><span class="co">##  3 family=gaussian spa… &lt;chr&gt; FALSE  gaussi…    14.5 train.R 2023-02-28 11:08:55</span></span>
<span><span class="co">##  4 family=gaussian spa… &lt;chr&gt; FALSE  gaussi…    14.2 train.R 2023-02-28 11:08:55</span></span>
<span><span class="co">##  5 family=gaussian spa… &lt;chr&gt; FALSE  gaussi…    12.4 train.R 2023-02-28 11:08:54</span></span>
<span><span class="co">##  6 family=symmetric sp… &lt;chr&gt; FALSE  symmet…    15.0 train.R 2023-02-28 11:08:54</span></span>
<span><span class="co">##  7 family=symmetric sp… &lt;chr&gt; FALSE  symmet…    14.9 train.R 2023-02-28 11:08:53</span></span>
<span><span class="co">##  8 family=symmetric sp… &lt;chr&gt; FALSE  symmet…    14.8 train.R 2023-02-28 11:08:52</span></span>
<span><span class="co">##  9 family=symmetric sp… &lt;chr&gt; FALSE  symmet…    14.6 train.R 2023-02-28 11:08:52</span></span>
<span><span class="co">## 10 family=symmetric sp… &lt;chr&gt; FALSE  symmet…    12.6 train.R 2023-02-28 11:08:51</span></span>
<span><span class="co">## # … with 11 more rows, 10 more variables: flags$span &lt;dbl&gt;, scalars$mse &lt;dbl&gt;,</span></span>
<span><span class="co">## #   stopped &lt;dttm&gt;, comments &lt;list&gt;, status &lt;chr&gt;, exit_status &lt;int&gt;,</span></span>
<span><span class="co">## #   deps &lt;list&gt;, project_dir &lt;chr&gt;, dir &lt;chr&gt;, id &lt;chr&gt;, and abbreviated</span></span>
<span><span class="co">## #   variable names ¹​flags$family, ²​scalars$rmse, ³​operation</span></span>
<span></span>
<span><span class="va">runs</span> <span class="op">&lt;-</span> <span class="va">runs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># filter out runs that didn't print 'rmse: &lt;numeric&gt;'</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">scalars</span><span class="op">$</span><span class="va">rmse</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># filter out runs where the flag `span` was over 1.5</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">flags</span><span class="op">$</span><span class="va">span</span> <span class="op">&lt;=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">runs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flags</span><span class="op">$</span><span class="va">span</span>, y <span class="op">=</span> <span class="va">scalars</span><span class="op">$</span><span class="va">rmse</span>,</span>
<span>             color <span class="op">=</span> <span class="va">flags</span><span class="op">$</span><span class="va">family</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="guildai_files/figure-markdown/unnamed-chunk-27-1.png"></p>
</div>
</div>
<div class="cell" paged.print="false">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_run</span> <span class="op">&lt;-</span> <span class="va">runs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">flags</span><span class="op">$</span><span class="va">family</span> <span class="op">==</span> <span class="st">"gaussian"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">scalars</span><span class="op">$</span><span class="va">rmse</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">best_run</span><span class="op">)</span></span>
<span><span class="co">## Rows: 2</span></span>
<span><span class="co">## Columns: 15</span></span>
<span><span class="co">## $ label       &lt;chr&gt; "family=gaussian span=0.3", "family=gaussian span=0.3"</span></span>
<span><span class="co">## $ tags        &lt;list&gt; &lt;&gt;, &lt;&gt;</span></span>
<span><span class="co">## $ marked      &lt;lgl&gt; FALSE, FALSE</span></span>
<span><span class="co">## $ flags       &lt;tibble[,2]&gt; &lt;tbl_df[2 x 2]&gt;</span></span>
<span><span class="co">## $ scalars     &lt;tibble[,2]&gt; &lt;tbl_df[2 x 2]&gt;</span></span>
<span><span class="co">## $ operation   &lt;chr&gt; "train.R", "train.R"</span></span>
<span><span class="co">## $ started     &lt;dttm&gt; 2023-02-28 11:08:54, 2023-02-28 11:08:49</span></span>
<span><span class="co">## $ stopped     &lt;dttm&gt; 2023-02-28 11:08:55, 2023-02-28 11:08:49</span></span>
<span><span class="co">## $ comments    &lt;list&gt; [&lt;tbl_df[0 x 4]&gt;], [&lt;tbl_df[0 x 4]&gt;]</span></span>
<span><span class="co">## $ status      &lt;chr&gt; "completed", "completed"</span></span>
<span><span class="co">## $ exit_status &lt;int&gt; 0, 0</span></span>
<span><span class="co">## $ deps        &lt;list&gt; [], []</span></span>
<span><span class="co">## $ project_dir &lt;chr&gt; "/tmp/RtmpA9r0F6/guildai-intro-sample-project-4acc12bdedaa…</span></span>
<span><span class="co">## $ dir         &lt;chr&gt; "/tmp/RtmpA9r0F6/guildai-intro-sample-project-4acc12bdeda…</span></span>
<span><span class="co">## $ id          &lt;chr&gt; "cea87b68b6aa42218b8f1182d652e28c", "3d6b88fd3df743488debc…</span></span>
<span></span>
<span><span class="va">best_run</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/runs_label.html">runs_tag</a></span><span class="op">(</span><span class="st">"best"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/runs_export.html">runs_export</a></span><span class="op">(</span><span class="st">"./best-runs"</span><span class="op">)</span></span>
<span><span class="co">## Modified tags for 2 run(s)</span></span>
<span><span class="co">## Copying cea87b68b6aa42218b8f1182d652e28c</span></span>
<span><span class="co">## Copying 3d6b88fd3df743488debcb18e9e18327</span></span>
<span><span class="co">## Exported 2 run(s) to ./best-runs</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-guild-from-the-terminal">Using guild from the terminal<a class="anchor" aria-label="anchor" href="#using-guild-from-the-terminal"></a>
</h3>
<p><code>guild</code> can also be used directly from the terminal. Call
the R function <code><a href="../reference/install_guild_cli.html">install_guild_cli()</a></code> to place the
<code>guild</code> executable installed by
<code><a href="../reference/install_guild.html">guildai::install_guild()</a></code> on your PATH:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">export_guild_cli</span><span class="op">(</span>dest <span class="op">=</span> <span class="st">"~/bin"</span><span class="op">)</span></span></code></pre></div>
<p>Then you can launch runs and perform other guild operations from the
terminal:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">guild</span> run train.R</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">guild</span> run train.R batch_size=<span class="st">'[32,64]'</span></span></code></pre></div>
<p>As you move between the terminal and the R console, almost all of the
same syntax supported at the terminal can be used in R by passing
strings to the respective R functions.</p>
<p>By default, R character vectors supplied to <code>...</code>
throughout most R functions are quoted for the system shell and passed
through to guild. This enables usage like:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guild_run.html">guild_run</a></span><span class="op">(</span><span class="st">"train.R"</span>, <span class="st">"batch_size=[32,64]"</span><span class="op">)</span></span></code></pre></div>
<p>There are some additional conveniences provided for passing through
command line options from R.</p>
<ul>
<li>Use <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code> to avoid quoting a string for the shell,
allowing you to pass through multiple arguments in a single string.</li>
<li>For arguments that take values, you can pass them from R as named
arguments or named objects.</li>
<li>Named arguments are automatically translated from R conventions to
shell conventions:
<ul>
<li>
<code>_</code> in a argument name is converted to <code>-</code>,
and a <code>--</code> prefix is automatically added, so
<code>batch_comment = "foo"</code> becomes
<code>--batch-comment 'foo'</code>.</li>
<li>boolean values are understood to be switches, so
<code>running = TRUE</code> is translated to <code>--running</code>,
while<code>running = FALSE</code> is translated
to<code>--not-running</code>.</li>
<li>names vectors are automatically recycled for the shell, so
<code>tag = c("a", "b" "c")</code> becomes
<code>--tag a --tag b --tag c</code>.</li>
<li>A single leading <code>.</code> in an argument name is treated as a
short option name, e.g., <code>.Fs = "last hour"</code> becomes
<code>-Fs 'last hour'</code>
</li>
<li>Nested lists are recursively flattened into a single character
vector</li>
</ul>
</li>
</ul>
<p>Here are a few different R expressions that invoke <code>guild</code>
with identical system calls.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span>marked <span class="op">=</span> <span class="cn">TRUE</span>, started <span class="op">=</span> <span class="st">'last hour'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="st">"--marked"</span>, <span class="st">"--started"</span> <span class="op">=</span> <span class="st">"last hour"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="st">"--marked"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--started"</span>, <span class="st">"last hour"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="st">"--marked"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--started"</span> <span class="op">=</span> <span class="st">"last hour"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"--marked"</span>, <span class="st">"--started"</span>, <span class="st">"last hour"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="st">"--marked --started 'last hour'"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="st">"-Fm -Fs 'last hour'"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span>.Fm <span class="op">=</span> <span class="cn">TRUE</span>, .Fs <span class="op">=</span> <span class="st">'last hour'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runs_info.html">runs_info</a></span><span class="op">(</span><span class="st">"-Fm"</span>, <span class="st">"-Fs"</span> <span class="op">=</span> <span class="st">"last hour"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="addin">Addin<a class="anchor" aria-label="anchor" href="#addin"></a>
</h4>
<p>The <strong>guildai</strong> package installs an RStudio IDE addin
which provides quick access to frequently used functions from the Addins
menu:</p>
<p>Note that you can use <strong>Tools</strong> -&gt; <strong>Modify
Keyboard Shortcuts</strong> within RStudio to assign a keyboard shortcut
to one or more of the addin commands.</p>
<p>Specifically three addins are provided:</p>
<ul>
<li>Launch a <code><a href="../reference/guild_run.html">guild_run()</a></code> with the current source
document.</li>
<li>Launch <code><a href="../reference/guild_view.html">guild_view()</a></code>.</li>
<li>View <code><a href="../reference/runs_info.html">runs_info()</a></code> in the interactive table viewer.</li>
</ul>
<p>It’s recommended that the action for “Launch
<code><a href="../reference/guild_run.html">guild_run()</a></code>” be assigned to keyboard shortcut Ctrl/Cmd +
Alt + Enter.</p>
</div>
<div class="section level4">
<h4 id="background-training">Background Training<a class="anchor" aria-label="anchor" href="#background-training"></a>
</h4>
<p>Since training runs can become quite lengthy, it’s often useful to
run them in the background in order to keep the R console free for other
work. In the RStudio IDE, <code><a href="../reference/guild_run.html">guild_run()</a></code> automatically
launches runs as background jobs. To disable this feature, set
<code>options(guildai.run_as_job = FALSE)</code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="learn-more">Learn More<a class="anchor" aria-label="anchor" href="#learn-more"></a>
</h2>
<p>See <a href="https://my.guild.ai/t/guild-ai-documentation/64" class="external-link uri">https://my.guild.ai/t/guild-ai-documentation/64</a> for more
information.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tomasz Kalinowski, Posit, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
